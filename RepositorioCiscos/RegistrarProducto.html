<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Rgistra Producto</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='CSS/bootstrap.css'>
    <link rel='stylesheet' type='text/css' media='screen' href='CSS/StyleRegistro.css'>
    <script src="JS/scriptIndex4.js"></script>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="menu">
                    <img src="IMG/Imagen1.png" alt="Logo" width="30" height="24" class="d-inline-block align-text-top">
                    Empresa X
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                    <div class="navbar-nav">
                        <a class="nav-link active" aria-current="page" href="Index4.html">Inicio</a>
                        <a class="nav-link" href="#">Tablas</a>
                        <a class="nav-link" href="https://facebook.com">Facebook</a>
                        <a class="nav-link disabled">Deshabilitado</a>
                    </div>
                </div>
                <label id="hola">HOLA, <strong id="name"></strong></label>
                <a data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">
                    <img src="IMG/UserI.png" id="perfil"></a>
                </a>
            </div>
        </nav>
          <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
            <div class="offcanvas-header bg-dark">
              <h5 class="offcanvas-title" id="offcanvasExampleLabel">TU PERFIL</a></h5>
              <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
              <div>
                <center><p><img src="IMG/UserI.png" width="150" height="150"></p></center>
                <p><strong>Tu correo: </strong><a href = "mailto: email"><strong id="email"></strong></a></p>
                <p><strong class="laContra" id="password"></strong></p>
              </div>
            </div>
            <div class="boton">
                <center><a href="Index2.html"><button type="button" id="nuevo" class="btn btn-success">Cerrar Sesión</button></a></center>
            </div>
    </header>
    <main>
        <div class="container">
            <div class="row">
                <div class="col-4 offset-4"><!--form-->
                    <center>
                        <img src="IMG/cajaIcon.png" alt="Logo provisional" width="75" height="75">
                        <h1>REGISTRAR PRODUCTO</h1>
                    </center>
                    <form action="VerProducto.html" method="get" id="miFormulario">
                        <div class="form-group mt-3 mb-2">
                            <label for="nombre">Nombre: </label>
                            <input class="form-control" id="nombre" type="text" name="nombre">
                            <label for="cantidad">Cantidad: </label>
                            <input class="form-control" id="cantidad" type="number" name="cantidad">
                            <label for="precio">Precio: </label>
                            <input class="form-control" id="precio" type="number" name="precio">
                            <label for="proveedor">Proveedor: </label>
                            <input class="form-control" id="proveedor" type="text" name="proveedor">
                            <label for="fecha">Fecha de ingreso: </label>
                            <input class="form-control" id="fecha" type="date" name="fecha">
                            <label for="secciones">Sección: </label>
                            <select name="secciones" aria-placeholder="selecciona una sección" class="form-select" id="seccion">
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                                <option value="D">D</option>
                            </select>
                        </div>
                        <div id="nuevos"></div>
                        <center><input class="btn btn-dark mr-2" type="submit" id="save" value="Registrar Producto" /></center>
                    </form>
                </div>
            </div>
        </div>
    </main>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const index = urlParams.get('index');
        const productos = JSON.parse(localStorage.getItem('productos')) || [];

        if (index !== null) {
            const producto = productos[index];
            document.getElementById('nombre').value = producto.nombre;
            document.getElementById('cantidad').value = producto.cantidad;
            document.getElementById('precio').value = producto.precio;
            document.getElementById('proveedor').value = producto.proveedor;
            document.getElementById('fecha').value = producto.fecha;
            document.getElementById('seccion').value = producto.seccion;
        }

        document.getElementById('miFormulario').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const producto = {
                nombre: document.getElementById('nombre').value,
                cantidad: document.getElementById('cantidad').value,
                precio: document.getElementById('precio').value,
                proveedor: document.getElementById('proveedor').value,
                fecha: document.getElementById('fecha').value,
                seccion: document.getElementById('seccion').value
            };

            if (index !== null) {
                productos[index] = producto;
            } else {
                productos.push(producto);
            }

            localStorage.setItem('productos', JSON.stringify(productos));

            window.location.href = 'VerProducto.html';
        });
    </script> 
    <script src='JS/bootstrap.js'></script>
</body>
</html>
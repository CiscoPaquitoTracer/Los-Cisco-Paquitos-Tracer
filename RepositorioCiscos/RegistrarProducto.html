<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Rgistra Producto</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='CSS/bootstrap.css'>
</head>
<body>
    <main>
        <div class="container">
            <div class="row">
                <div class="col-4 offset-4"><!--form-->
                    <center>
                        <img src="IMG/cajaIcon.png" alt="Logo provisional" width="75" height="75">
                        <h1>BIENVENIDO</h1>
                    </center>
                    <form action="VerProducto.html" method="get" id="miFormulario">
                        <div class="form-group mt-3 mb-2">
                            <label for="nombre">Nombre: </label>
                            <input class="form-control" id="nombre" type="text" name="nombre">
                            <label for="cantidad">Cantidad: </label>
                            <input class="form-control" id="cantidad" type="number" name="cantidad">
                            <label for="precio">Precio: </label>
                            <input class="form-control" id="precio" type="number" name="precio">
                            <label for="proveedor">Proveedor: </label>
                            <input class="form-control" id="proveedor" type="text" name="proveedor">
                            <label for="fecha">Fecha de ingreso: </label>
                            <input class="form-control" id="fecha" type="date" name="fecha">
                            <label for="secciones">Sección: </label>
                            <select name="secciones" aria-placeholder="selecciona una sección" class="form-select" id="seccion">
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                                <option value="D">D</option>
                            </select>
                        </div>
                        <div id="nuevos"></div>
                        <center><input class="btn btn-dark mr-2" type="submit" id="save" value="Registrar Personas" /></center>
                    </form>
                </div>
            </div>
        </div>
    </main>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const index = urlParams.get('index');
        const productos = JSON.parse(localStorage.getItem('productos')) || [];

        if (index !== null) {
            const producto = productos[index];
            document.getElementById('nombre').value = producto.nombre;
            document.getElementById('cantidad').value = producto.cantidad;
            document.getElementById('precio').value = producto.precio;
            document.getElementById('proveedor').value = producto.proveedor;
            document.getElementById('fecha').value = producto.fecha;
            document.getElementById('seccion').value = producto.seccion;
        }

        document.getElementById('miFormulario').addEventListener('submit', function(event) {
            event.preventDefault();
            
            const producto = {
                nombre: document.getElementById('nombre').value,
                cantidad: document.getElementById('cantidad').value,
                precio: document.getElementById('precio').value,
                proveedor: document.getElementById('proveedor').value,
                fecha: document.getElementById('fecha').value,
                seccion: document.getElementById('seccion').value
            };

            if (index !== null) {
                productos[index] = producto;
            } else {
                productos.push(producto);
            }

            localStorage.setItem('productos', JSON.stringify(productos));

            window.location.href = 'VerProducto.html';
        });
    </script> 
    <script src='JS/bootstrap.js'></script>
</body>
</html>